# second pwn

![изображение](https://user-images.githubusercontent.com/64375994/151368623-447deafd-8f37-4578-87f5-dd1e68cb34ad.png)

В функции main мы видим четыре последовательных классичесих уязвимости форматной строки ([format string vulnerability](https://owasp.org/www-community/attacks/Format_string_attack))

Следующий шаг: найти "выигрывающую" функцию. Это функция check, вызываемая из main:

![изображение](https://user-images.githubusercontent.com/64375994/151369313-6b4d5c9b-b587-498d-bc07-20791148879c.png)

Как можно заметить, для выполнения `system("/bin/sh")` нужно равенство четырёх глобальных переменных определённым значениям. Это условие как раз и можно выполнить с помощью эксплуатации уязвимости форматной строки: последовательно размещаем на стеке адреса, а затем с помощью спецификатора %hn записываем в них желаемые значения.
