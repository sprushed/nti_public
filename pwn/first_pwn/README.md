# first_pwn

При анализе исполняемого файла с помощью методов реверс-инжиниринга мы замечаем уязвимость переполнения буфера на стеке. Однако функции "выигрыша" в программе нет, поэтому нам нужно сделать её самим. Обычный метод решения такой проблемы - Return Oriented Programming. Классические задачи с описаниями решений при помощи метода эксплуатации ROP можно увидеть [тут](https://ropemporium.com).

Итак, в данном случае наша стратегия такова:

1. Прыгнуть на ROP-гаджет с инструкцией pop rdi, таким образом получая возможность записать первый аргумент соглашения о вызовах fastcall в x64 Linux.
2. В качестве записываемого аргумента передать адрес функции puts в Global Offset Table.
3. Затем прыгнуть на саму функцию puts внутри исполняемого файла, таким образом получая адрес внутри библиотеки libc.
4. Зная базовый адрес libc можно получить адрес функции system и строки "/bin/sh" в libc
5. С помощью вышеприведённого алгоритма загружаем адрес строки "/bin/sh" в регистр RDI.
6. Прыгаем на функцию system в libc.
7. Hack the planet!
